<template>
  <div v-if="shouldShow" class="notice-container">
    <div class="notice-circle" @click="toggleModal">
      <el-icon class="circle-icon"><BellFilled /></el-icon>
    </div>

    <transition name="fade">
      <div
        v-if="isModalOpen"
        class="notice-overlay"
        @click.self="toggleModal"
      >
        <div class="notice-card animate-pop">
          <div class="card-header">
            <h3>ç”µè„‘æŠ¥ä¿®é¡»çŸ¥</h3>
            <button class="close-btn" @click="toggleModal">
              <el-icon><Close /></el-icon>
            </button>
          </div>
          
          <div class="card-body custom-scrollbar">
            <div class="notice-section">
              <h4><span class="emoji">ğŸ› ï¸</span> æŠ¥ä¿®æŒ‡å¼•</h4>
              <ol>
                <li>
                  <strong>ç½‘ç»œé—®é¢˜ï¼š</strong> è¯·ç›´æ¥è”ç³»å­¦æ ¡ç½‘ç»œä¸­å¿ƒã€‚
                  <div class="sub-info">æ¾å±±æ¹–: 22861378 | å…¶å®ƒæ ¡åŒº: 22680756</div>
                </li>
                <li>
                  <strong>ç¡¬ä»¶é™åˆ¶ï¼š</strong> å¸ˆå‹å›¢é˜Ÿæš‚ä¸æ”¯æŒç¡¬ä»¶æ•…éšœç»´ä¿®ï¼ˆå¦‚ä¸»æ¿æŸåï¼‰ï¼Œè¯·è”ç³»å‚å®¶å¤„ç†ã€‚
                </li>
                <li>
                  <strong>æè¿°è§„èŒƒï¼š</strong> æŠ¥ä¿®æ—¶è¯·å°½å¯èƒ½è¯¦ç»†æè¿°æ•…éšœç°è±¡ã€‚
                </li>
                <li>
                  <strong>å“åº”æ—¶é—´ï¼š</strong> ä¸€èˆ¬ä¸ºå·¥ä½œæ—¥ï¼Œ1-2ä¸ªå·¥ä½œæ—¥å†…ä¼šä¸æ‚¨è”ç³»ã€‚
                </li>
                <li>
                  <strong>ç´§æ€¥è”ç³»ï¼š</strong>
                  <div class="contact-grid">
                     <div class="contact-item">é™†æ™“å½¤: 14778189977</div>
                     <div class="contact-item">åˆ˜å¥•è±ª: 13714721480</div>
                  </div>
                </li>
              </ol>
            </div>

            <div class="notice-section warning">
              <h4><span class="emoji">ğŸ’¡</span> æ¸©é¦¨æç¤º</h4>
              <ul>
                <li>èåŸæ ¡åŒºæŠ¥ä¿®ç³»ç»Ÿå°šæœªå¼€æ”¾ã€‚</li>
                <li>ç”µè¯ä»…ç”¨äºç´§æ€¥æƒ…å†µï¼Œè¯¾åæ—¶é—´æä¾›å’¨è¯¢ã€‚</li>
                <li>è¯·åŠ¡å¿…ç¡®è®¤è”ç³»æ–¹å¼æ­£ç¡®ã€‚</li>
                <li>å¸ˆå‹æ˜¯æ ¡å†…å”¯ä¸€çš„å…è´¹ä¹‰åŠ¡ç»´ä¿®ç»„ç»‡ï¼Œæ‚¨çš„ç†è§£æ˜¯æˆ‘ä»¬æœ€å¤§çš„åŠ¨åŠ›ã€‚</li>
                <li>å¸ˆå‹æä¾›çš„ç¡…è„‚æ€§èƒ½æ™®é€šï¼Œå¦‚æœ‰é«˜è¦æ±‚è¯·è‡ªå¤‡ã€‚</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </transition>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue';
import { useRoute } from 'vue-router';
import { BellFilled, Close } from '@element-plus/icons-vue'; // å¼•å…¥å›¾æ ‡

// State
const isModalOpen = ref(false);

// Router
const route = useRoute();
const loginPaths = ['/login', '/register', '/resetPassword'];

// Computed
const shouldShow = computed(() => {
  return !loginPaths.includes(route.path);
});

// Methods
const toggleModal = () => {
  isModalOpen.value = !isModalOpen.value;
};
</script>

<style scoped>
.notice-container {
  position: fixed;
  bottom: 30px;
  right: 30px;
  z-index: 2000;
}

/* æ‚¬æµ®çƒä¼˜åŒ– */
.notice-circle {
  width: 56px;
  height: 56px;
  background: linear-gradient(135deg, #409eff, #337ecc);
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  box-shadow: 0 8px 20px rgba(64, 158, 255, 0.4);
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.notice-circle:hover {
  transform: scale(1.1) translateY(-2px);
  box-shadow: 0 12px 25px rgba(64, 158, 255, 0.5);
}
.circle-icon {
  color: white;
  font-size: 24px;
}

/* é®ç½©ä¸å¡ç‰‡ */
.notice-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2001;
  padding: 20px;
}

.notice-card {
  background: #fff;
  width: 100%;
  max-width: 600px;
  max-height: 85vh;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  overflow: hidden;
}

.card-header {
  padding: 20px 24px;
  border-bottom: 1px solid #f0f2f5;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #fff;
}
.card-header h3 {
  margin: 0;
  font-size: 18px;
  color: #303133;
}

.close-btn {
  background: transparent;
  border: none;
  font-size: 20px;
  color: #909399;
  cursor: pointer;
  padding: 4px;
  border-radius: 50%;
  transition: background 0.2s;
  display: flex;
}
.close-btn:hover { background: #f2f3f5; color: #606266; }

.card-body {
  padding: 24px;
  overflow-y: auto;
  font-size: 14px;
  line-height: 1.6;
  color: #606266;
}

/* å†…å®¹æ ·å¼ä¼˜åŒ– */
.notice-section { margin-bottom: 24px; }
.notice-section h4 {
  margin: 0 0 12px;
  color: #303133;
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.emoji { font-size: 18px; }

ol, ul { padding-left: 20px; margin: 0; }
li { margin-bottom: 8px; }
li:last-child { margin-bottom: 0; }

.sub-info {
  font-size: 13px;
  color: #909399;
  margin-top: 4px;
  background: #f9f9f9;
  padding: 4px 8px;
  border-radius: 4px;
  display: inline-block;
}

.contact-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-top: 6px;
}
.contact-item {
  background: #ecf5ff;
  color: #409eff;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
}

.notice-section.warning {
  background: #fdf6ec;
  padding: 16px;
  border-radius: 12px;
  border: 1px solid #faecd8;
}
.notice-section.warning h4 { color: #e6a23c; }
.notice-section.warning li::marker { color: #e6a23c; }

/* æ»šåŠ¨æ¡ç¾åŒ– */
.custom-scrollbar::-webkit-scrollbar { width: 6px; }
.custom-scrollbar::-webkit-scrollbar-thumb { background: #dcdfe6; border-radius: 3px; }
.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }

/* åŠ¨ç”» */
.fade-enter-active, .fade-leave-active { transition: opacity 0.2s ease; }
.fade-enter-from, .fade-leave-to { opacity: 0; }

.animate-pop { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes popIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}
</style>